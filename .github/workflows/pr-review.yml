on:
    pull_request:
        types: [opened, reopened, ready_for_review]
    issue_comment:
        types: [created]

jobs:
    pr_agent_job:
        if: ${{ github.event.sender.type != 'Bot' }}
        runs-on: ubuntu-latest
        permissions:
            issues: write
            pull-requests: write
            contents: write
        name: Run pr agent on every pull request, respond to user comments
        steps:
        - name: PR Agent action step
          id: pragent
          uses: Codium-ai/pr-agent@main
          env:
            OPENAI.KEY: ${{ secrets.OPENAI_KEY }}
            OPENAI.API_BASE: https://api.sambanova.ai
            CONFIG.MODEL: "openai/Meta-Llama-3.2-3B-Instruct"
            CONFIG.MODEL_TURBO: "openai/Meta-Llama-3.1-70B-Instruct"
            CONFIG.CUSTOM_MODEL_MAX_TOKENS: 64000
            GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
            litellm.set_verbose: true
